version: "3"
services:
  app:
    # build:
    #   context: .
    #   dockerfile: Dockerfile
    #   args:
    #     - DATABASE_URL=${DATABASE_URL}
    #     - GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID}
    #     - GOOGLE_CLIENT_SECRET=${GOOGLE_CLIENT_SECRET}
    #     - NAVER_ID=${NAVER_ID}
    #     - NAVER_SECRET=${NAVER_SECRET}
    #     - NEXTAUTH_URL=${NEXTAUTH_URL}
    #     - NEXTAUTH_SECRET=${NEXTAUTH_SECRET}
    image: hangakim/keyword_finder:latest
    ports:
      - "3000:3000" # 컨테이너의 80 포트를 호스트의 80 포트로 매핑
    env_file:
      - .env
    command: npm start # 컨테이너가 시작될 때 실행할 명령어를 지정
    expose:
      - "3000" # 네트워크 내부에서 접근 가능하도록 설정

nginx:
  build:
    context: .
    target: runner
  ports:
    - "80:80" # Nginx 컨테이너의 80 포트를 호스트의 80 포트로 매핑
  depends_on:
    - app
